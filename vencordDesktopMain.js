// Vencord c696c18
// Standalone: false
// Platform: linux
"use strict";var xt=Object.create;var Nr=Object.defineProperty;var St=Object.getOwnPropertyDescriptor;var Tt=Object.getOwnPropertyNames;var Et=Object.getPrototypeOf,Dt=Object.prototype.hasOwnProperty;var ir=(r,t)=>()=>(r&&(t=r(r=0)),t);var Rt=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Tt(t))!Dt.call(r,i)&&i!==e&&Nr(r,i,{get:()=>t[i],enumerable:!(n=St(t,i))||n.enumerable});return r};var zt=(r,t,e)=>(e=r!=null?xt(Et(r)):{},Rt(t||!r||!r.__esModule?Nr(e,"default",{value:r,enumerable:!0}):e,r));var l=ir(()=>{"use strict"});var or=ir(()=>{"use strict";l()});function J(r){return async function(){try{return{ok:!0,value:await r(...arguments)}}catch(t){return{ok:!1,error:t instanceof Error?{...t}:t}}}}var kr=ir(()=>{"use strict";l()});var Ut={};function ar(...r){let t={cwd:Fr};return Ar?Cr("flatpak-spawn",["--host","git",...r],t):Cr("git",r,t)}async function Gt(){return(await ar("remote","get-url","origin")).stdout.trim().replace(/git@(.+):/,"https://$1/").replace(/\.git$/,"")}async function Zt(){await ar("fetch");let t=(await ar("log","HEAD...origin/main","--pretty=format:%an/%h/%s")).stdout.trim();return t?t.split(`
`).map(e=>{let[n,i,...a]=e.split("/");return{hash:i,author:n,message:a.join("/")}}):[]}async function Vt(){return(await ar("pull")).stdout.includes("Fast-forward")}async function Pt(){return!(await Cr(Ar?"flatpak-spawn":"node",Ar?["--host","node","scripts/build/build.mjs"]:["scripts/build/build.mjs"],{cwd:Fr})).stderr.includes("Build failed")}var Or,q,Lr,Wr,Fr,Cr,Ar,Kr=ir(()=>{"use strict";l();or();Or=require("child_process"),q=require("electron"),Lr=require("path"),Wr=require("util");kr();Fr=(0,Lr.join)(__dirname,".."),Cr=(0,Wr.promisify)(Or.execFile),Ar=Boolean(process.env.FLATPAK_ID?.includes("discordapp")||process.env.FLATPAK_ID?.includes("Discord"));q.ipcMain.handle("VencordGetRepo",J(Gt));q.ipcMain.handle("VencordGetUpdates",J(Zt));q.ipcMain.handle("VencordUpdate",J(Vt));q.ipcMain.handle("VencordBuild",J(Pt))});l();var k=require("electron"),yt=require("path");l();l();Promise.resolve().then(()=>Kr());l();or();var Br=require("electron"),jr=require("https"),Nt=/^https:\/\/(spotify\.link|s\.team)\/.+$/;function _r(r){return new Promise((t,e)=>{let n=(0,jr.request)(new URL(r),{method:"HEAD"},i=>{t(i.headers.location?_r(i.headers.location):r)});n.on("error",e),n.end()})}Br.ipcMain.handle("VencordOIAResolveRedirect",async(r,t)=>Nt.test(t)?_r(t):t);l();or();l();var b=class{constructor(t=1/0){this.maxSize=t}queue=[];promise;next(){let t=this.queue.shift();t?this.promise=Promise.resolve().then(t).finally(()=>this.next()):this.promise=void 0}run(){this.promise||this.next()}push(t){this.size>=this.maxSize&&this.queue.shift(),this.queue.push(t),this.run()}unshift(t){this.size>=this.maxSize&&this.queue.pop(),this.queue.unshift(t),this.run()}get size(){return this.queue.length}};var m=require("electron"),rr=require("fs"),K=require("fs/promises"),Qr=require("path");l();var Yr="PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KICAgIDxoZWFkPgogICAgICAgIDxtZXRhIGNoYXJzZXQ9InV0Zi04IiAvPgogICAgICAgIDx0aXRsZT5WZW5jb3JkIFF1aWNrQ1NTIEVkaXRvcjwvdGl0bGU+CiAgICAgICAgPGxpbmsKICAgICAgICAgICAgcmVsPSJzdHlsZXNoZWV0IgogICAgICAgICAgICBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9tb25hY28tZWRpdG9yLzAuMzcuMS9taW4vdnMvZWRpdG9yL2VkaXRvci5tYWluLm1pbi5jc3MiCiAgICAgICAgICAgIGludGVncml0eT0ic2hhNTEyLXdCM3hmTDk4aFdnMWJwa1ZZU3lMMGpzL0p4OXM3RnNEZzlhWU82bk9NU0pUZ1B1ay9QRnF4WFFKS0tTVWp0ZVpqZVlyZmdvOU5GQk9BMXI5SHdEdVp3PT0iCiAgICAgICAgICAgIGNyb3Nzb3JpZ2luPSJhbm9ueW1vdXMiCiAgICAgICAgICAgIHJlZmVycmVycG9saWN5PSJuby1yZWZlcnJlciIKICAgICAgICAvPgogICAgICAgIDxzdHlsZT4KICAgICAgICAgICAgaHRtbCwKICAgICAgICAgICAgYm9keSwKICAgICAgICAgICAgI2NvbnRhaW5lciB7CiAgICAgICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgICAgICAgICBsZWZ0OiAwOwogICAgICAgICAgICAgICAgdG9wOiAwOwogICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgICAgICAgICBtYXJnaW46IDA7CiAgICAgICAgICAgICAgICBwYWRkaW5nOiAwOwogICAgICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICAgICAgfQogICAgICAgIDwvc3R5bGU+CiAgICA8L2hlYWQ+CgogICAgPGJvZHk+CiAgICAgICAgPGRpdiBpZD0iY29udGFpbmVyIj48L2Rpdj4KICAgICAgICA8c2NyaXB0CiAgICAgICAgICAgIHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvbW9uYWNvLWVkaXRvci8wLjM3LjEvbWluL3ZzL2xvYWRlci5taW4uanMiCiAgICAgICAgICAgIGludGVncml0eT0ic2hhNTEyLUErNlN2UEdrSU45UmYwbVVYbVc0eGg3ckR2QUxYZi9mMFZ0T1VpSGxEVVNQa251MmtjZnoxS3pMcE9KeUwycE8rblpTMTNoaElqTHFWZ2lRRXhMSnJ3PT0iCiAgICAgICAgICAgIGNyb3Nzb3JpZ2luPSJhbm9ueW1vdXMiCiAgICAgICAgICAgIHJlZmVycmVycG9saWN5PSJuby1yZWZlcnJlciIKICAgICAgICA+PC9zY3JpcHQ+CgogICAgICAgIDxzY3JpcHQ+CiAgICAgICAgICAgIHJlcXVpcmUuY29uZmlnKHsKICAgICAgICAgICAgICAgIHBhdGhzOiB7CiAgICAgICAgICAgICAgICAgICAgdnM6ICJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9tb25hY28tZWRpdG9yLzAuMzcuMS9taW4vdnMiLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZXF1aXJlKFsidnMvZWRpdG9yL2VkaXRvci5tYWluIl0sICgpID0+IHsKICAgICAgICAgICAgICAgIGdldEN1cnJlbnRDc3MoKS50aGVuKChjc3MpID0+IHsKICAgICAgICAgICAgICAgICAgICB2YXIgZWRpdG9yID0gbW9uYWNvLmVkaXRvci5jcmVhdGUoCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb250YWluZXIiKSwKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGNzcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhbmd1YWdlOiAiY3NzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW1lOiBnZXRUaGVtZSgpLAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICBlZGl0b3Iub25EaWRDaGFuZ2VNb2RlbENvbnRlbnQoKCkgPT4KICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q3NzKGVkaXRvci5nZXRWYWx1ZSgpKQogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWFrZSBtb25hY28gcmUtbGF5b3V0CiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5sYXlvdXQoKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICA8L3NjcmlwdD4KICAgIDwvYm9keT4KPC9odG1sPgo=";l();var Xr=require("electron"),F=require("path"),mr=process.env.VENCORD_USER_DATA_DIR??(process.env.DISCORD_USER_DATA_DIR?(0,F.join)(process.env.DISCORD_USER_DATA_DIR,"..","VencordData"):(0,F.join)(Xr.app.getPath("userData"),"..","Vencord")),$=(0,F.join)(mr,"settings"),sr=(0,F.join)($,"quickCss.css"),yr=(0,F.join)($,"settings.json"),Hr=["https:","http:","steam:","spotify:","com.epicgames.launcher:"];(0,rr.mkdirSync)($,{recursive:!0});function kt(){return(0,K.readFile)(sr,"utf-8").catch(()=>"")}function Jr(){try{return(0,rr.readFileSync)(yr,"utf-8")}catch{return"{}"}}function qr(){try{return JSON.parse(Jr())}catch{return{}}}m.ipcMain.handle("VencordOpenQuickCss",()=>m.shell.openPath(sr));m.ipcMain.handle("VencordOpenExternal",(r,t)=>{try{var{protocol:e}=new URL(t)}catch{throw"Malformed URL"}if(!Hr.includes(e))throw"Disallowed protocol.";m.shell.openExternal(t)});var Mt=new b,Ot=new b;m.ipcMain.handle("VencordGetQuickCss",()=>kt());m.ipcMain.handle("VencordSetQuickCss",(r,t)=>Mt.push(()=>(0,K.writeFile)(sr,t)));m.ipcMain.handle("VencordGetSettingsDir",()=>$);m.ipcMain.on("VencordGetSettings",r=>r.returnValue=Jr());m.ipcMain.handle("VencordSetSettings",(r,t)=>{Ot.push(()=>(0,K.writeFile)(yr,t))});m.ipcMain.handle("VencordOpenMonacoEditor",async()=>{await new m.BrowserWindow({title:"Vencord QuickCSS Editor",autoHideMenuBar:!0,darkTheme:!0,webPreferences:{preload:(0,Qr.join)(__dirname,"preload.js"),contextIsolation:!0,nodeIntegration:!1,sandbox:!1}}).loadURL(`data:text/html;base64,${Yr}`)});l();var Ct=require("electron");l();var rt=require("module"),Lt=(0,rt.createRequire)("/"),ur,Wt=";var __w=require('worker_threads');__w.parentPort.on('message',function(m){onmessage({data:m})}),postMessage=function(m,t){__w.parentPort.postMessage(m,t)},close=process.exit;self=global";try{ur=Lt("worker_threads").Worker}catch{}var Ft=ur?function(r,t,e,n,i){var a=!1,s=new ur(r+Wt,{eval:!0}).on("error",function(f){return i(f,null)}).on("message",function(f){return i(null,f)}).on("exit",function(f){f&&!a&&i(new Error("exited with code "+f),null)});return s.postMessage(e,n),s.terminate=function(){return a=!0,ur.prototype.terminate.call(s)},s}:function(r,t,e,n,i){setImmediate(function(){return i(new Error("async operations unsupported - update to Node 12+ (or Node 10-11 with the --experimental-worker CLI flag)"),null)});var a=function(){};return{terminate:a,postMessage:a}},I=Uint8Array,P=Uint16Array,xr=Uint32Array,Sr=new I([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Tr=new I([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),tt=new I([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),et=function(r,t){for(var e=new P(31),n=0;n<31;++n)e[n]=t+=1<<r[n-1];for(var i=new xr(e[30]),n=1;n<30;++n)for(var a=e[n];a<e[n+1];++a)i[a]=a-e[n]<<5|n;return[e,i]},nt=et(Sr,2),Er=nt[0],Kt=nt[1];Er[28]=258,Kt[258]=28;var it=et(Tr,0),ot=it[0],Ue=it[1],hr=new P(32768);for(c=0;c<32768;++c)R=(c&43690)>>>1|(c&21845)<<1,R=(R&52428)>>>2|(R&13107)<<2,R=(R&61680)>>>4|(R&3855)<<4,hr[c]=((R&65280)>>>8|(R&255)<<8)>>>1;var R,c,B=function(r,t,e){for(var n=r.length,i=0,a=new P(t);i<n;++i)r[i]&&++a[r[i]-1];var s=new P(t);for(i=0;i<t;++i)s[i]=s[i-1]+a[i-1]<<1;var f;if(e){f=new P(1<<t);var o=15-t;for(i=0;i<n;++i)if(r[i])for(var u=i<<4|r[i],h=t-r[i],g=s[r[i]-1]++<<h,x=g|(1<<h)-1;g<=x;++g)f[hr[g]>>>o]=u}else for(f=new P(n),i=0;i<n;++i)r[i]&&(f[i]=hr[s[r[i]-1]++]>>>15-r[i]);return f},tr=new I(288);for(c=0;c<144;++c)tr[c]=8;var c;for(c=144;c<256;++c)tr[c]=9;var c;for(c=256;c<280;++c)tr[c]=7;var c;for(c=280;c<288;++c)tr[c]=8;var c,at=new I(32);for(c=0;c<32;++c)at[c]=5;var c;var st=B(tr,9,1);var ft=B(at,5,1),lr=function(r){for(var t=r[0],e=1;e<r.length;++e)r[e]>t&&(t=r[e]);return t},w=function(r,t,e){var n=t/8|0;return(r[n]|r[n+1]<<8)>>(t&7)&e},cr=function(r,t){var e=t/8|0;return(r[e]|r[e+1]<<8|r[e+2]<<16)>>(t&7)},ut=function(r){return(r+7)/8|0},gr=function(r,t,e){(t==null||t<0)&&(t=0),(e==null||e>r.length)&&(e=r.length);var n=new(r.BYTES_PER_ELEMENT==2?P:r.BYTES_PER_ELEMENT==4?xr:I)(e-t);return n.set(r.subarray(t,e)),n};var lt=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],y=function(r,t,e){var n=new Error(t||lt[r]);if(n.code=r,Error.captureStackTrace&&Error.captureStackTrace(n,y),!e)throw n;return n},ct=function(r,t,e){var n=r.length;if(!n||e&&e.f&&!e.l)return t||new I(0);var i=!t||e,a=!e||e.i;e||(e={}),t||(t=new I(n*3));var s=function(Vr){var Pr=t.length;if(Vr>Pr){var Ur=new I(Math.max(Pr*2,Vr));Ur.set(t),t=Ur}},f=e.f||0,o=e.p||0,u=e.b||0,h=e.l,g=e.d,x=e.m,z=e.n,_=n*8;do{if(!h){f=w(r,o,1);var U=w(r,o+1,3);if(o+=3,U)if(U==1)h=st,g=ft,x=9,z=5;else if(U==2){var Z=w(r,o,31)+257,M=w(r,o+10,15)+4,Y=Z+w(r,o+5,31)+1;o+=14;for(var N=new I(Y),X=new I(19),p=0;p<M;++p)X[tt[p]]=w(r,o+p*3,7);o+=M*3;for(var D=lr(X),er=(1<<D)-1,O=B(X,D,1),p=0;p<Y;){var H=O[w(r,o,er)];o+=H&15;var v=H>>>4;if(v<16)N[p++]=v;else{var L=0,nr=0;for(v==16?(nr=3+w(r,o,3),o+=2,L=N[p-1]):v==17?(nr=3+w(r,o,7),o+=3):v==18&&(nr=11+w(r,o,127),o+=7);nr--;)N[p++]=L}}var zr=N.subarray(0,Z),V=N.subarray(Z);x=lr(zr),z=lr(V),h=B(zr,x,1),g=B(V,z,1)}else y(1);else{var v=ut(o)+4,d=r[v-4]|r[v-3]<<8,G=v+d;if(G>n){a&&y(0);break}i&&s(u+d),t.set(r.subarray(v,G),u),e.b=u+=d,e.p=o=G*8,e.f=f;continue}if(o>_){a&&y(0);break}}i&&s(u+131072);for(var dt=(1<<x)-1,wt=(1<<z)-1,vr=o;;vr=o){var L=h[cr(r,o)&dt],W=L>>>4;if(o+=L&15,o>_){a&&y(0);break}if(L||y(2),W<256)t[u++]=W;else if(W==256){vr=o,h=null;break}else{var Gr=W-254;if(W>264){var p=W-257,Q=Sr[p];Gr=w(r,o,(1<<Q)-1)+Er[p],o+=Q}var pr=g[cr(r,o)&wt],Ir=pr>>>4;pr||y(3),o+=pr&15;var V=ot[Ir];if(Ir>3){var Q=Tr[Ir];V+=cr(r,o)&(1<<Q)-1,o+=Q}if(o>_){a&&y(0);break}i&&s(u+131072);for(var Zr=u+Gr;u<Zr;u+=4)t[u]=t[u-V],t[u+1]=t[u+1-V],t[u+2]=t[u+2-V],t[u+3]=t[u+3-V];u=Zr}}e.l=h,e.p=vr,e.b=u,e.f=f,h&&(f=1,e.m=x,e.d=g,e.n=z)}while(!f);return u==t.length?t:gr(t,0,u)};var Bt=new I(0);var jt=function(r,t){var e={};for(var n in r)e[n]=r[n];for(var n in t)e[n]=t[n];return e},br=function(r,t,e){for(var n=r(),i=r.toString(),a=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),s=0;s<n.length;++s){var f=n[s],o=a[s];if(typeof f=="function"){t+=";"+o+"=";var u=f.toString();if(f.prototype)if(u.indexOf("[native code]")!=-1){var h=u.indexOf(" ",8)+1;t+=u.slice(h,u.indexOf("(",h))}else{t+=u;for(var g in f.prototype)t+=";"+o+".prototype."+g+"="+f.prototype[g].toString()}else t+=u}else e[o]=f}return[t,e]},fr=[],_t=function(r){var t=[];for(var e in r)r[e].buffer&&t.push((r[e]=new r[e].constructor(r[e])).buffer);return t},Yt=function(r,t,e,n){var i;if(!fr[e]){for(var a="",s={},f=r.length-1,o=0;o<f;++o)i=br(r[o],a,s),a=i[0],s=i[1];fr[e]=br(r[f],a,s)}var u=jt({},fr[e][1]);return Ft(fr[e][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",e,u,_t(u),n)},Xt=function(){return[I,P,xr,Sr,Tr,tt,Er,ot,st,ft,hr,lt,B,lr,w,cr,ut,gr,y,ct,Dr,ht,gt]};var ht=function(r){return postMessage(r,[r.buffer])},gt=function(r){return r&&r.size&&new I(r.size)},Ht=function(r,t,e,n,i,a){var s=Yt(e,n,i,function(f,o){s.terminate(),a(f,o)});return s.postMessage([r,t],t.consume?[r.buffer]:[]),function(){s.terminate()}};var T=function(r,t){return r[t]|r[t+1]<<8},S=function(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16|r[t+3]<<24)>>>0},dr=function(r,t){return S(r,t)+S(r,t+4)*4294967296};function Qt(r,t,e){return e||(e=t,t={}),typeof e!="function"&&y(7),Ht(r,t,[Xt],function(n){return ht(Dr(n.data[0],gt(n.data[1])))},1,e)}function Dr(r,t){return ct(r,t)}var wr=typeof TextDecoder<"u"&&new TextDecoder,Jt=0;try{wr.decode(Bt,{stream:!0}),Jt=1}catch{}var qt=function(r){for(var t="",e=0;;){var n=r[e++],i=(n>127)+(n>223)+(n>239);if(e+i>r.length)return[t,gr(r,e-1)];i?i==3?(n=((n&15)<<18|(r[e++]&63)<<12|(r[e++]&63)<<6|r[e++]&63)-65536,t+=String.fromCharCode(55296|n>>10,56320|n&1023)):i&1?t+=String.fromCharCode((n&31)<<6|r[e++]&63):t+=String.fromCharCode((n&15)<<12|(r[e++]&63)<<6|r[e++]&63):t+=String.fromCharCode(n)}};function bt(r,t){if(t){for(var e="",n=0;n<r.length;n+=16384)e+=String.fromCharCode.apply(null,r.subarray(n,n+16384));return e}else{if(wr)return wr.decode(r);var i=qt(r),a=i[0],s=i[1];return s.length&&y(8),a}}var $t=function(r,t){return t+30+T(r,t+26)+T(r,t+28)},re=function(r,t,e){var n=T(r,t+28),i=bt(r.subarray(t+46,t+46+n),!(T(r,t+8)&2048)),a=t+46+n,s=S(r,t+20),f=e&&s==4294967295?te(r,a):[s,S(r,t+24),S(r,t+42)],o=f[0],u=f[1],h=f[2];return[T(r,t+10),o,u,i,a+T(r,t+30)+T(r,t+32),h]},te=function(r,t){for(;T(r,t)!=1;t+=4+T(r,t+2));return[dr(r,t+12),dr(r,t+4),dr(r,t+20)]};var $r=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(r){r()};function vt(r,t,e){e||(e=t,t={}),typeof e!="function"&&y(7);var n=[],i=function(){for(var v=0;v<n.length;++v)n[v]()},a={},s=function(v,d){$r(function(){e(v,d)})};$r(function(){s=e});for(var f=r.length-22;S(r,f)!=101010256;--f)if(!f||r.length-f>65558)return s(y(13,0,1),null),i;var o=T(r,f+8);if(o){var u=o,h=S(r,f+16),g=h==4294967295||u==65535;if(g){var x=S(r,f-12);g=S(r,x)==101075792,g&&(u=o=S(r,x+32),h=S(r,x+48))}for(var z=t&&t.filter,_=function(v){var d=re(r,h,g),G=d[0],Z=d[1],M=d[2],Y=d[3],N=d[4],X=d[5],p=$t(r,X);h=N;var D=function(O,H){O?(i(),s(O,null)):(H&&(a[Y]=H),--o||s(null,a))};if(!z||z({name:Y,size:Z,originalSize:M,compression:G}))if(!G)D(null,gr(r,p,p+Z));else if(G==8){var er=r.subarray(p,p+Z);if(Z<32e4)try{D(null,Dr(er,new I(M)))}catch(O){D(O,null)}else n.push(Qt(er,{size:M},D))}else D(y(14,"unknown compression type "+G,1),null);else D(null,null)},U=0;U<u;++U)_(U)}else s(null,{});return i}var At=require("fs"),E=require("fs/promises"),j=require("path");l();function pt(r){function t(s,f,o,u){let h=0;return h+=s<<0,h+=f<<8,h+=o<<16,h+=u<<24>>>0,h}if(r[0]===80&&r[1]===75&&r[2]===3&&r[3]===4)return r;if(r[0]!==67||r[1]!==114||r[2]!==50||r[3]!==52)throw new Error("Invalid header: Does not start with Cr24");let e=r[4]===3,n=r[4]===2;if(!n&&!e||r[5]||r[6]||r[7])throw new Error("Unexpected crx format version number.");if(n){let s=t(r[8],r[9],r[10],r[11]),f=t(r[12],r[13],r[14],r[15]),o=16+s+f;return r.subarray(o,r.length)}let a=12+t(r[8],r[9],r[10],r[11]);return r.subarray(a,r.length)}l();var It=zt(require("https"));function Rr(r,t={}){return new Promise((e,n)=>{It.default.get(r,t,i=>{let{statusCode:a,statusMessage:s,headers:f}=i;if(a>=400)return void n(`${a}: ${s} - ${r}`);if(a>=300)return void e(Rr(f.location,t));let o=[];i.on("error",n),i.on("data",u=>o.push(u)),i.once("end",()=>e(Buffer.concat(o)))})})}var ee=(0,j.join)(mr,"ExtensionCache");async function ne(r,t){return await(0,E.mkdir)(t,{recursive:!0}),new Promise((e,n)=>{vt(r,(i,a)=>{if(i)return void n(i);Promise.all(Object.keys(a).map(async s=>{if(s.startsWith("_metadata/"))return;if(s.endsWith("/"))return void(0,E.mkdir)((0,j.join)(t,s),{recursive:!0});let f=s.split("/"),o=f.pop(),u=f.join("/"),h=(0,j.join)(t,u);u&&await(0,E.mkdir)(h,{recursive:!0}),await(0,E.writeFile)((0,j.join)(h,o),a[s])})).then(()=>e()).catch(s=>{(0,E.rm)(t,{recursive:!0,force:!0}),n(s)})})})}async function mt(r){let t=(0,j.join)(ee,`${r}`);try{await(0,E.access)(t,At.constants.F_OK)}catch{let n=r==="fmkadmapgofadopljbjfkapdkoienihi"?"https://raw.githubusercontent.com/Vendicated/random-files/f6f550e4c58ac5f2012095a130406c2ab25b984d/fmkadmapgofadopljbjfkapdkoienihi.zip":`https://clients2.google.com/service/update2/crx?response=redirect&acceptformat=crx2,crx3&x=id%3D${r}%26uc&prodversion=32`,i=await Rr(n,{headers:{"User-Agent":"Vencord (https://github.com/Vendicated/Vencord)"}});await ne(pt(i),t).catch(console.error)}Ct.session.defaultSession.loadExtension(t)}k.app.whenReady().then(()=>{k.protocol.registerFileProtocol("vencord",({url:n},i)=>{let a=n.slice(10);switch(a.endsWith("/")&&(a=a.slice(0,-1)),a){case"renderer.js.map":case"vencordDesktopRenderer.js.map":case"preload.js.map":case"patcher.js.map":case"vencordDesktopMain.js.map":i((0,yt.join)(__dirname,a));break;default:i({statusCode:403})}});try{qr().enableReactDevtools&&mt("fmkadmapgofadopljbjfkapdkoienihi").then(()=>console.info("[Vencord] Installed React Developer Tools")).catch(n=>console.error("[Vencord] Failed to install React Developer Tools",n))}catch{}let r=n=>{let i={};return n.split(";").forEach(a=>{let[s,...f]=a.trim().split(/\s+/g);s&&!Object.prototype.hasOwnProperty.call(i,s)&&(i[s]=f)}),i},t=n=>Object.entries(n).filter(([,i])=>i?.length).map(i=>i.flat().join(" ")).join("; ");function e(n,i){if(i in n){let a=r(n[i][0]);for(let s of["style-src","connect-src","img-src","font-src","media-src","worker-src"])a[s]=["*","blob:","data:","'unsafe-inline'"];a["script-src"]??=[],a["script-src"].push("'unsafe-eval'","https://unpkg.com","https://cdnjs.cloudflare.com"),n[i]=[t(a)]}}k.session.defaultSession.webRequest.onHeadersReceived(({responseHeaders:n,resourceType:i},a)=>{n&&(i==="mainFrame"&&e(n,"content-security-policy"),i==="stylesheet"&&(n["content-type"]=["text/css"])),a({cancel:!1,responseHeaders:n})}),k.session.defaultSession.webRequest.onHeadersReceived=()=>{}});
//# sourceURL=VencordDesktopMain
//# sourceMappingURL=vencord://vencordDesktopMain.js.map
/*! For license information please see vencordDesktopMain.js.LEGAL.txt */
