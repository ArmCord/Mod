// Vencord c696c18
// Standalone: false
// Platform: linux
"use strict";var _e=Object.create;var wr=Object.defineProperty;var Be=Object.getOwnPropertyDescriptor;var Ke=Object.getOwnPropertyNames;var je=Object.getPrototypeOf,He=Object.prototype.hasOwnProperty;var y=(r,e)=>()=>(r&&(e=r(r=0)),e);var Kr=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Ke(e))!He.call(r,i)&&i!==t&&wr(r,i,{get:()=>e[i],enumerable:!(n=Be(e,i))||n.enumerable});return r};var xr=(r,e,t)=>(t=r!=null?_e(je(r)):{},Kr(e||!r||!r.__esModule?wr(t,"default",{value:r,enumerable:!0}):t,r)),Ye=r=>Kr(wr({},"__esModule",{value:!0}),r);var f=y(()=>{"use strict"});var ur=y(()=>{"use strict";f()});function er(r){return async function(){try{return{ok:!0,value:await r(...arguments)}}catch(e){return{ok:!1,error:e instanceof Error?{...e}:e}}}}var jr=y(()=>{"use strict";f()});var Je={};function fr(...r){let e={cwd:Qr};return Tr?Sr("flatpak-spawn",["--host","git",...r],e):Sr("git",r,e)}async function be(){return(await fr("remote","get-url","origin")).stdout.trim().replace(/git@(.+):/,"https://$1/").replace(/\.git$/,"")}async function qe(){await fr("fetch");let e=(await fr("log","HEAD...origin/main","--pretty=format:%an/%h/%s")).stdout.trim();return e?e.split(`
`).map(t=>{let[n,i,...o]=t.split("/");return{hash:i,author:n,message:o.join("/")}}):[]}async function Qe(){return(await fr("pull")).stdout.includes("Fast-forward")}async function Xe(){return!(await Sr(Tr?"flatpak-spawn":"node",Tr?["--host","node","scripts/build/build.mjs"]:["scripts/build/build.mjs"],{cwd:Qr})).stderr.includes("Build failed")}var Yr,tr,br,qr,Qr,Sr,Tr,Xr=y(()=>{"use strict";f();ur();Yr=require("child_process"),tr=require("electron"),br=require("path"),qr=require("util");jr();Qr=(0,br.join)(__dirname,".."),Sr=(0,qr.promisify)(Yr.execFile),Tr=Boolean(process.env.FLATPAK_ID?.includes("discordapp")||process.env.FLATPAK_ID?.includes("Discord"));tr.ipcMain.handle("VencordGetRepo",er(be));tr.ipcMain.handle("VencordGetUpdates",er(qe));tr.ipcMain.handle("VencordUpdate",er(Qe));tr.ipcMain.handle("VencordBuild",er(Xe))});var Jr=y(()=>{"use strict";f();Promise.resolve().then(()=>Xr())});function ee(r){return new Promise((e,t)=>{let n=(0,re.request)(new URL(r),{method:"HEAD"},i=>{e(i.headers.location?ee(i.headers.location):r)});n.on("error",t),n.end()})}var $r,re,$e,te=y(()=>{"use strict";f();ur();$r=require("electron"),re=require("https"),$e=/^https:\/\/(spotify\.link|s\.team)\/.+$/;$r.ipcMain.handle("VencordOIAResolveRedirect",async(r,e)=>$e.test(e)?ee(e):e)});function ne(r,e=300){let t;return function(...n){clearTimeout(t),t=setTimeout(()=>{r(...n)},e)}}var ie=y(()=>{"use strict";f()});var nr,oe=y(()=>{"use strict";f();nr=class{constructor(e=1/0){this.maxSize=e}queue=[];promise;next(){let e=this.queue.shift();e?this.promise=Promise.resolve().then(e).finally(()=>this.next()):this.promise=void 0}run(){this.promise||this.next()}push(e){this.size>=this.maxSize&&this.queue.shift(),this.queue.push(e),this.run()}unshift(e){this.size>=this.maxSize&&this.queue.pop(),this.queue.unshift(e),this.run()}get size(){return this.queue.length}}});var ae,se=y(()=>{f();ae="PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KICAgIDxoZWFkPgogICAgICAgIDxtZXRhIGNoYXJzZXQ9InV0Zi04IiAvPgogICAgICAgIDx0aXRsZT5WZW5jb3JkIFF1aWNrQ1NTIEVkaXRvcjwvdGl0bGU+CiAgICAgICAgPGxpbmsKICAgICAgICAgICAgcmVsPSJzdHlsZXNoZWV0IgogICAgICAgICAgICBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9tb25hY28tZWRpdG9yLzAuMzcuMS9taW4vdnMvZWRpdG9yL2VkaXRvci5tYWluLm1pbi5jc3MiCiAgICAgICAgICAgIGludGVncml0eT0ic2hhNTEyLXdCM3hmTDk4aFdnMWJwa1ZZU3lMMGpzL0p4OXM3RnNEZzlhWU82bk9NU0pUZ1B1ay9QRnF4WFFKS0tTVWp0ZVpqZVlyZmdvOU5GQk9BMXI5SHdEdVp3PT0iCiAgICAgICAgICAgIGNyb3Nzb3JpZ2luPSJhbm9ueW1vdXMiCiAgICAgICAgICAgIHJlZmVycmVycG9saWN5PSJuby1yZWZlcnJlciIKICAgICAgICAvPgogICAgICAgIDxzdHlsZT4KICAgICAgICAgICAgaHRtbCwKICAgICAgICAgICAgYm9keSwKICAgICAgICAgICAgI2NvbnRhaW5lciB7CiAgICAgICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgICAgICAgICBsZWZ0OiAwOwogICAgICAgICAgICAgICAgdG9wOiAwOwogICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgICAgICAgICBtYXJnaW46IDA7CiAgICAgICAgICAgICAgICBwYWRkaW5nOiAwOwogICAgICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICAgICAgfQogICAgICAgIDwvc3R5bGU+CiAgICA8L2hlYWQ+CgogICAgPGJvZHk+CiAgICAgICAgPGRpdiBpZD0iY29udGFpbmVyIj48L2Rpdj4KICAgICAgICA8c2NyaXB0CiAgICAgICAgICAgIHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvbW9uYWNvLWVkaXRvci8wLjM3LjEvbWluL3ZzL2xvYWRlci5taW4uanMiCiAgICAgICAgICAgIGludGVncml0eT0ic2hhNTEyLUErNlN2UEdrSU45UmYwbVVYbVc0eGg3ckR2QUxYZi9mMFZ0T1VpSGxEVVNQa251MmtjZnoxS3pMcE9KeUwycE8rblpTMTNoaElqTHFWZ2lRRXhMSnJ3PT0iCiAgICAgICAgICAgIGNyb3Nzb3JpZ2luPSJhbm9ueW1vdXMiCiAgICAgICAgICAgIHJlZmVycmVycG9saWN5PSJuby1yZWZlcnJlciIKICAgICAgICA+PC9zY3JpcHQ+CgogICAgICAgIDxzY3JpcHQ+CiAgICAgICAgICAgIHJlcXVpcmUuY29uZmlnKHsKICAgICAgICAgICAgICAgIHBhdGhzOiB7CiAgICAgICAgICAgICAgICAgICAgdnM6ICJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9tb25hY28tZWRpdG9yLzAuMzcuMS9taW4vdnMiLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZXF1aXJlKFsidnMvZWRpdG9yL2VkaXRvci5tYWluIl0sICgpID0+IHsKICAgICAgICAgICAgICAgIGdldEN1cnJlbnRDc3MoKS50aGVuKChjc3MpID0+IHsKICAgICAgICAgICAgICAgICAgICB2YXIgZWRpdG9yID0gbW9uYWNvLmVkaXRvci5jcmVhdGUoCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb250YWluZXIiKSwKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGNzcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhbmd1YWdlOiAiY3NzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW1lOiBnZXRUaGVtZSgpLAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICBlZGl0b3Iub25EaWRDaGFuZ2VNb2RlbENvbnRlbnQoKCkgPT4KICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q3NzKGVkaXRvci5nZXRWYWx1ZSgpKQogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWFrZSBtb25hY28gcmUtbGF5b3V0CiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5sYXlvdXQoKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICA8L3NjcmlwdD4KICAgIDwvYm9keT4KPC9odG1sPgo="});var le,j,Er,ir,H,Dr,ue,cr,or=y(()=>{"use strict";f();le=require("electron"),j=require("path"),Er=process.env.VENCORD_USER_DATA_DIR??(process.env.DISCORD_USER_DATA_DIR?(0,j.join)(process.env.DISCORD_USER_DATA_DIR,"..","VencordData"):(0,j.join)(le.app.getPath("userData"),"..","Vencord")),ir=(0,j.join)(Er,"settings"),H=(0,j.join)(ir,"quickCss.css"),Dr=(0,j.join)(ir,"settings.json"),ue=["https:","http:","steam:","spotify:","com.epicgames.launcher:"],cr=process.argv.includes("--vanilla")});function ce(){return(0,M.readFile)(H,"utf-8").catch(()=>"")}function he(){try{return(0,Y.readFileSync)(Dr,"utf-8")}catch{return"{}"}}function hr(){try{return JSON.parse(he())}catch{return{}}}function ge(r){(0,M.open)(H,"a+").then(e=>{e.close(),(0,Y.watch)(H,{persistent:!1},ne(async()=>{r.webContents.postMessage("VencordQuickCssUpdate",await ce())},50))})}var m,Y,M,fe,rt,et,Rr=y(()=>{"use strict";f();Jr();te();ie();ur();oe();m=require("electron"),Y=require("fs"),M=require("fs/promises"),fe=require("path");se();or();(0,Y.mkdirSync)(ir,{recursive:!0});m.ipcMain.handle("VencordOpenQuickCss",()=>m.shell.openPath(H));m.ipcMain.handle("VencordOpenExternal",(r,e)=>{try{var{protocol:t}=new URL(e)}catch{throw"Malformed URL"}if(!ue.includes(t))throw"Disallowed protocol.";m.shell.openExternal(e)});rt=new nr,et=new nr;m.ipcMain.handle("VencordGetQuickCss",()=>ce());m.ipcMain.handle("VencordSetQuickCss",(r,e)=>rt.push(()=>(0,M.writeFile)(H,e)));m.ipcMain.handle("VencordGetSettingsDir",()=>ir);m.ipcMain.on("VencordGetSettings",r=>r.returnValue=he());m.ipcMain.handle("VencordSetSettings",(r,e)=>{et.push(()=>(0,M.writeFile)(Dr,e))});m.ipcMain.handle("VencordOpenMonacoEditor",async()=>{await new m.BrowserWindow({title:"Vencord QuickCSS Editor",autoHideMenuBar:!0,darkTheme:!0,webPreferences:{preload:(0,fe.join)(__dirname,"preload.js"),contextIsolation:!0,nodeIntegration:!1,sandbox:!1}}).loadURL(`data:text/html;base64,${ae}`)})});function ke(r,e,t){let n=e;if(e in r)return void t(r[n]);Object.defineProperty(r,e,{set(i){delete r[n],r[n]=i,t(i)},configurable:!0,enumerable:!1})}var Ze=y(()=>{"use strict";f()});var St={};var W,V,yt,wt,Zr,xt,Me=y(()=>{"use strict";f();Ze();W=xr(require("electron")),V=require("path");Rr();or();console.log("[Vencord] Starting up...");yt=require.main.filename,wt=require.main.path.endsWith("app.asar")?"_app.asar":"app.asar",Zr=(0,V.join)((0,V.dirname)(yt),"..",wt),xt=require((0,V.join)(Zr,"package.json"));require.main.filename=(0,V.join)(Zr,xt.main);W.app.setAppPath(Zr);if(cr)console.log("[Vencord] Running in vanilla mode. Not loading Vencord");else{let r=hr();class e extends W.default.BrowserWindow{constructor(i){if(i?.webPreferences?.preload&&i.title){let o=i.webPreferences.preload;i.webPreferences.preload=(0,V.join)(__dirname,"preload.js"),i.webPreferences.sandbox=!1,r.frameless&&(i.frame=!1),r.transparentUNSAFE_USE_AT_OWN_RISK&&(i.transparent=!0,i.backgroundColor="#00000000"),r.macosTranslucency,process.env.DISCORD_PRELOAD=o,super(i),ge(this)}else super(i)}}Object.assign(e,W.default.BrowserWindow),Object.defineProperty(e,"name",{value:"BrowserWindow",configurable:!0});let t=require.resolve("electron");delete require.cache[t].exports,require.cache[t].exports={...W.default,BrowserWindow:e},ke(global,"appSettings",n=>{n.set("DANGEROUS_ENABLE_DEVTOOLS_ONLY_ENABLE_IF_YOU_KNOW_WHAT_YOURE_DOING",!0),r.disableMinSize?(n.set("MIN_WIDTH",0),n.set("MIN_HEIGHT",0)):(n.set("MIN_WIDTH",940),n.set("MIN_HEIGHT",500))}),process.env.DATA_DIR=(0,V.join)(W.app.getPath("userData"),"..","Vencord")}console.log("[Vencord] Loading original Discord app.asar");require(require.main.filename)});f();var L=require("electron"),We=require("path");Rr();or();f();var Oe=require("electron");f();var Ie=require("module"),tt=(0,Ie.createRequire)("/"),pr,nt=";var __w=require('worker_threads');__w.parentPort.on('message',function(m){onmessage({data:m})}),postMessage=function(m,t){__w.parentPort.postMessage(m,t)},close=process.exit;self=global";try{pr=tt("worker_threads").Worker}catch{}var it=pr?function(r,e,t,n,i){var o=!1,s=new pr(r+nt,{eval:!0}).on("error",function(l){return i(l,null)}).on("message",function(l){return i(null,l)}).on("exit",function(l){l&&!o&&i(new Error("exited with code "+l),null)});return s.postMessage(t,n),s.terminate=function(){return o=!0,pr.prototype.terminate.call(s)},s}:function(r,e,t,n,i){setImmediate(function(){return i(new Error("async operations unsupported - update to Node 12+ (or Node 10-11 with the --experimental-worker CLI flag)"),null)});var o=function(){};return{terminate:o,postMessage:o}},A=Uint8Array,U=Uint16Array,Gr=Uint32Array,Nr=new A([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Or=new A([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ce=new A([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ae=function(r,e){for(var t=new U(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];for(var i=new Gr(t[30]),n=1;n<30;++n)for(var o=t[n];o<t[n+1];++o)i[o]=o-t[n]<<5|n;return[t,i]},me=Ae(Nr,2),Ur=me[0],ot=me[1];Ur[28]=258,ot[258]=28;var de=Ae(Or,0),ye=de[0],rn=de[1],Cr=new U(32768);for(c=0;c<32768;++c)z=(c&43690)>>>1|(c&21845)<<1,z=(z&52428)>>>2|(z&13107)<<2,z=(z&61680)>>>4|(z&3855)<<4,Cr[c]=((z&65280)>>>8|(z&255)<<8)>>>1;var z,c,b=function(r,e,t){for(var n=r.length,i=0,o=new U(e);i<n;++i)r[i]&&++o[r[i]-1];var s=new U(e);for(i=0;i<e;++i)s[i]=s[i-1]+o[i-1]<<1;var l;if(t){l=new U(1<<e);var a=15-e;for(i=0;i<n;++i)if(r[i])for(var u=i<<4|r[i],h=e-r[i],g=s[r[i]-1]++<<h,S=g|(1<<h)-1;g<=S;++g)l[Cr[g]>>>a]=u}else for(l=new U(n),i=0;i<n;++i)r[i]&&(l[i]=Cr[s[r[i]-1]++]>>>15-r[i]);return l},ar=new A(288);for(c=0;c<144;++c)ar[c]=8;var c;for(c=144;c<256;++c)ar[c]=9;var c;for(c=256;c<280;++c)ar[c]=7;var c;for(c=280;c<288;++c)ar[c]=8;var c,we=new A(32);for(c=0;c<32;++c)we[c]=5;var c;var xe=b(ar,9,1);var Se=b(we,5,1),vr=function(r){for(var e=r[0],t=1;t<r.length;++t)r[t]>e&&(e=r[t]);return e},x=function(r,e,t){var n=e/8|0;return(r[n]|r[n+1]<<8)>>(e&7)&t},Ir=function(r,e){var t=e/8|0;return(r[t]|r[t+1]<<8|r[t+2]<<16)>>(e&7)},Te=function(r){return(r+7)/8|0},Ar=function(r,e,t){(e==null||e<0)&&(e=0),(t==null||t>r.length)&&(t=r.length);var n=new(r.BYTES_PER_ELEMENT==2?U:r.BYTES_PER_ELEMENT==4?Gr:A)(t-e);return n.set(r.subarray(e,t)),n};var Ee=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],d=function(r,e,t){var n=new Error(e||Ee[r]);if(n.code=r,Error.captureStackTrace&&Error.captureStackTrace(n,d),!t)throw n;return n},De=function(r,e,t){var n=r.length;if(!n||t&&t.f&&!t.l)return e||new A(0);var i=!e||t,o=!t||t.i;t||(t={}),e||(e=new A(n*3));var s=function(Fr){var _r=e.length;if(Fr>_r){var Br=new A(Math.max(_r*2,Fr));Br.set(e),e=Br}},l=t.f||0,a=t.p||0,u=t.b||0,h=t.l,g=t.d,S=t.m,P=t.n,Q=n*8;do{if(!h){l=x(r,a,1);var k=x(r,a+1,3);if(a+=3,k)if(k==1)h=xe,g=Se,S=9,P=5;else if(k==2){var N=x(r,a,31)+257,F=x(r,a+10,15)+4,X=N+x(r,a+5,31)+1;a+=14;for(var Z=new A(X),J=new A(19),v=0;v<F;++v)J[Ce[v]]=x(r,a+v*3,7);a+=F*3;for(var R=vr(J),sr=(1<<R)-1,_=b(J,R,1),v=0;v<X;){var $=_[x(r,a,sr)];a+=$&15;var p=$>>>4;if(p<16)Z[v++]=p;else{var B=0,lr=0;for(p==16?(lr=3+x(r,a,3),a+=2,B=Z[v-1]):p==17?(lr=3+x(r,a,7),a+=3):p==18&&(lr=11+x(r,a,127),a+=7);lr--;)Z[v++]=B}}var Mr=Z.subarray(0,N),O=Z.subarray(N);S=vr(Mr),P=vr(O),h=b(Mr,S,1),g=b(O,P,1)}else d(1);else{var p=Te(a)+4,w=r[p-4]|r[p-3]<<8,G=p+w;if(G>n){o&&d(0);break}i&&s(u+w),e.set(r.subarray(p,G),u),t.b=u+=w,t.p=a=G*8,t.f=l;continue}if(a>Q){o&&d(0);break}}i&&s(u+131072);for(var Le=(1<<S)-1,Fe=(1<<P)-1,mr=a;;mr=a){var B=h[Ir(r,a)&Le],K=B>>>4;if(a+=B&15,a>Q){o&&d(0);break}if(B||d(2),K<256)e[u++]=K;else if(K==256){mr=a,h=null;break}else{var Wr=K-254;if(K>264){var v=K-257,rr=Nr[v];Wr=x(r,a,(1<<rr)-1)+Ur[v],a+=rr}var dr=g[Ir(r,a)&Fe],yr=dr>>>4;dr||d(3),a+=dr&15;var O=ye[yr];if(yr>3){var rr=Or[yr];O+=Ir(r,a)&(1<<rr)-1,a+=rr}if(a>Q){o&&d(0);break}i&&s(u+131072);for(var Lr=u+Wr;u<Lr;u+=4)e[u]=e[u-O],e[u+1]=e[u+1-O],e[u+2]=e[u+2-O],e[u+3]=e[u+3-O];u=Lr}}t.l=h,t.p=mr,t.b=u,t.f=l,h&&(l=1,t.m=S,t.d=g,t.n=P)}while(!l);return u==e.length?e:Ar(e,0,u)};var at=new A(0);var st=function(r,e){var t={};for(var n in r)t[n]=r[n];for(var n in e)t[n]=e[n];return t},pe=function(r,e,t){for(var n=r(),i=r.toString(),o=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),s=0;s<n.length;++s){var l=n[s],a=o[s];if(typeof l=="function"){e+=";"+a+"=";var u=l.toString();if(l.prototype)if(u.indexOf("[native code]")!=-1){var h=u.indexOf(" ",8)+1;e+=u.slice(h,u.indexOf("(",h))}else{e+=u;for(var g in l.prototype)e+=";"+a+".prototype."+g+"="+l.prototype[g].toString()}else e+=u}else t[a]=l}return[e,t]},gr=[],lt=function(r){var e=[];for(var t in r)r[t].buffer&&e.push((r[t]=new r[t].constructor(r[t])).buffer);return e},ut=function(r,e,t,n){var i;if(!gr[t]){for(var o="",s={},l=r.length-1,a=0;a<l;++a)i=pe(r[a],o,s),o=i[0],s=i[1];gr[t]=pe(r[l],o,s)}var u=st({},gr[t][1]);return it(gr[t][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",t,u,lt(u),n)},ft=function(){return[A,U,Gr,Nr,Or,Ce,Ur,ye,xe,Se,Cr,Ee,b,vr,x,Ir,Te,Ar,d,De,Vr,Re,ze]};var Re=function(r){return postMessage(r,[r.buffer])},ze=function(r){return r&&r.size&&new A(r.size)},ct=function(r,e,t,n,i,o){var s=ut(t,n,i,function(l,a){s.terminate(),o(l,a)});return s.postMessage([r,e],e.consume?[r.buffer]:[]),function(){s.terminate()}};var E=function(r,e){return r[e]|r[e+1]<<8},T=function(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0},zr=function(r,e){return T(r,e)+T(r,e+4)*4294967296};function ht(r,e,t){return t||(t=e,e={}),typeof t!="function"&&d(7),ct(r,e,[ft],function(n){return Re(Vr(n.data[0],ze(n.data[1])))},1,t)}function Vr(r,e){return De(r,e)}var Pr=typeof TextDecoder<"u"&&new TextDecoder,gt=0;try{Pr.decode(at,{stream:!0}),gt=1}catch{}var pt=function(r){for(var e="",t=0;;){var n=r[t++],i=(n>127)+(n>223)+(n>239);if(t+i>r.length)return[e,Ar(r,t-1)];i?i==3?(n=((n&15)<<18|(r[t++]&63)<<12|(r[t++]&63)<<6|r[t++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):i&1?e+=String.fromCharCode((n&31)<<6|r[t++]&63):e+=String.fromCharCode((n&15)<<12|(r[t++]&63)<<6|r[t++]&63):e+=String.fromCharCode(n)}};function vt(r,e){if(e){for(var t="",n=0;n<r.length;n+=16384)t+=String.fromCharCode.apply(null,r.subarray(n,n+16384));return t}else{if(Pr)return Pr.decode(r);var i=pt(r),o=i[0],s=i[1];return s.length&&d(8),o}}var It=function(r,e){return e+30+E(r,e+26)+E(r,e+28)},Ct=function(r,e,t){var n=E(r,e+28),i=vt(r.subarray(e+46,e+46+n),!(E(r,e+8)&2048)),o=e+46+n,s=T(r,e+20),l=t&&s==4294967295?At(r,o):[s,T(r,e+24),T(r,e+42)],a=l[0],u=l[1],h=l[2];return[E(r,e+10),a,u,i,o+E(r,e+30)+E(r,e+32),h]},At=function(r,e){for(;E(r,e)!=1;e+=4+E(r,e+2));return[zr(r,e+12),zr(r,e+4),zr(r,e+20)]};var ve=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(r){r()};function Pe(r,e,t){t||(t=e,e={}),typeof t!="function"&&d(7);var n=[],i=function(){for(var p=0;p<n.length;++p)n[p]()},o={},s=function(p,w){ve(function(){t(p,w)})};ve(function(){s=t});for(var l=r.length-22;T(r,l)!=101010256;--l)if(!l||r.length-l>65558)return s(d(13,0,1),null),i;var a=E(r,l+8);if(a){var u=a,h=T(r,l+16),g=h==4294967295||u==65535;if(g){var S=T(r,l-12);g=T(r,S)==101075792,g&&(u=a=T(r,S+32),h=T(r,S+48))}for(var P=e&&e.filter,Q=function(p){var w=Ct(r,h,g),G=w[0],N=w[1],F=w[2],X=w[3],Z=w[4],J=w[5],v=It(r,J);h=Z;var R=function(_,$){_?(i(),s(_,null)):($&&(o[X]=$),--a||s(null,o))};if(!P||P({name:X,size:N,originalSize:F,compression:G}))if(!G)R(null,Ar(r,v,v+N));else if(G==8){var sr=r.subarray(v,v+N);if(N<32e4)try{R(null,Vr(sr,new A(F)))}catch(_){R(_,null)}else n.push(ht(sr,{size:F},R))}else R(d(14,"unknown compression type "+G,1),null);else R(null,null)},k=0;k<u;++k)Q(k)}else s(null,{});return i}var Ue=require("fs"),D=require("fs/promises"),q=require("path");or();f();function Ge(r){function e(s,l,a,u){let h=0;return h+=s<<0,h+=l<<8,h+=a<<16,h+=u<<24>>>0,h}if(r[0]===80&&r[1]===75&&r[2]===3&&r[3]===4)return r;if(r[0]!==67||r[1]!==114||r[2]!==50||r[3]!==52)throw new Error("Invalid header: Does not start with Cr24");let t=r[4]===3,n=r[4]===2;if(!n&&!t||r[5]||r[6]||r[7])throw new Error("Unexpected crx format version number.");if(n){let s=e(r[8],r[9],r[10],r[11]),l=e(r[12],r[13],r[14],r[15]),a=16+s+l;return r.subarray(a,r.length)}let o=12+e(r[8],r[9],r[10],r[11]);return r.subarray(o,r.length)}f();var Ne=xr(require("https"));function kr(r,e={}){return new Promise((t,n)=>{Ne.default.get(r,e,i=>{let{statusCode:o,statusMessage:s,headers:l}=i;if(o>=400)return void n(`${o}: ${s} - ${r}`);if(o>=300)return void t(kr(l.location,e));let a=[];i.on("error",n),i.on("data",u=>a.push(u)),i.once("end",()=>t(Buffer.concat(a)))})})}var mt=(0,q.join)(Er,"ExtensionCache");async function dt(r,e){return await(0,D.mkdir)(e,{recursive:!0}),new Promise((t,n)=>{Pe(r,(i,o)=>{if(i)return void n(i);Promise.all(Object.keys(o).map(async s=>{if(s.startsWith("_metadata/"))return;if(s.endsWith("/"))return void(0,D.mkdir)((0,q.join)(e,s),{recursive:!0});let l=s.split("/"),a=l.pop(),u=l.join("/"),h=(0,q.join)(e,u);u&&await(0,D.mkdir)(h,{recursive:!0}),await(0,D.writeFile)((0,q.join)(h,a),o[s])})).then(()=>t()).catch(s=>{(0,D.rm)(e,{recursive:!0,force:!0}),n(s)})})})}async function Ve(r){let e=(0,q.join)(mt,`${r}`);try{await(0,D.access)(e,Ue.constants.F_OK)}catch{let n=r==="fmkadmapgofadopljbjfkapdkoienihi"?"https://raw.githubusercontent.com/Vendicated/random-files/f6f550e4c58ac5f2012095a130406c2ab25b984d/fmkadmapgofadopljbjfkapdkoienihi.zip":`https://clients2.google.com/service/update2/crx?response=redirect&acceptformat=crx2,crx3&x=id%3D${r}%26uc&prodversion=32`,i=await kr(n,{headers:{"User-Agent":"Vencord (https://github.com/Vendicated/Vencord)"}});await dt(Ge(i),e).catch(console.error)}Oe.session.defaultSession.loadExtension(e)}cr||L.app.whenReady().then(()=>{L.protocol.registerFileProtocol("vencord",({url:n},i)=>{let o=n.slice(10);switch(o.endsWith("/")&&(o=o.slice(0,-1)),o){case"renderer.js.map":case"vencordDesktopRenderer.js.map":case"preload.js.map":case"patcher.js.map":case"vencordDesktopMain.js.map":i((0,We.join)(__dirname,o));break;default:i({statusCode:403})}});try{hr().enableReactDevtools&&Ve("fmkadmapgofadopljbjfkapdkoienihi").then(()=>console.info("[Vencord] Installed React Developer Tools")).catch(n=>console.error("[Vencord] Failed to install React Developer Tools",n))}catch{}let r=n=>{let i={};return n.split(";").forEach(o=>{let[s,...l]=o.trim().split(/\s+/g);s&&!Object.prototype.hasOwnProperty.call(i,s)&&(i[s]=l)}),i},e=n=>Object.entries(n).filter(([,i])=>i?.length).map(i=>i.flat().join(" ")).join("; ");function t(n,i){if(i in n){let o=r(n[i][0]);for(let s of["style-src","connect-src","img-src","font-src","media-src","worker-src"])o[s]=["*","blob:","data:","'unsafe-inline'"];o["script-src"]??=[],o["script-src"].push("'unsafe-eval'","https://unpkg.com","https://cdnjs.cloudflare.com"),n[i]=[e(o)]}}L.session.defaultSession.webRequest.onHeadersReceived(({responseHeaders:n,resourceType:i},o)=>{n&&(i==="mainFrame"&&t(n,"content-security-policy"),i==="stylesheet"&&(n["content-type"]=["text/css"])),o({cancel:!1,responseHeaders:n})}),L.session.defaultSession.webRequest.onHeadersReceived=()=>{}});Me();
//# sourceURL=VencordPatcher
//# sourceMappingURL=vencord://patcher.js.map
/*! For license information please see patcher.js.LEGAL.txt */
